<!DOCTYPE html>
<html lang="en">
<head>
  <title>Vert.x Web Client - Vert.x</title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta content="Eclipse Vert.x is a tool-kit for building reactive applications on the JVM." name="description">
  <link href="https://vertx.tk/stylesheets/docs.css" media="screen" rel="stylesheet">
  <link href="https://vertx.tk/stylesheets/font-awesome.min.css" media="screen" rel="stylesheet">
  <link href="https://vertx.tk/javascripts/styles/rainbow.min.css" media="screen" rel="stylesheet">
  <!-- IE 6-8 support of HTML 5 elements -->
  <!--[if lt IE 9]>
  <script src="http://static.jboss.org/theme/js/libs/html5/pre3.6/html5.min.js"></script>
  <![endif]-->

  <link rel="apple-touch-icon" sizes="57x57" href="https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://vertx.tk/assets/favicons/vertx-favicon-7/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="https://vertx.tk/assets/favicons/vertx-favicon-7/favicon-32x32.png" sizes="32x32">
  <link rel="icon" type="image/png" href="https://vertx.tk/assets/favicons/vertx-favicon-7/android-chrome-192x192.png" sizes="192x192">
  <link rel="icon" type="image/png" href="https://vertx.tk/assets/favicons/vertx-favicon-7/favicon-96x96.png" sizes="96x96">
  <link rel="icon" type="image/png" href="https://vertx.tk/assets/favicons/vertx-favicon-7/favicon-16x16.png" sizes="16x16">
  <link rel="manifest" href="https://vertx.tk/assets/favicons/vertx-favicon-7/manifest.json">
  <link rel="mask-icon" href="https://vertx.tk/assets/favicons/vertx-favicon-7/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#7d3194">
  <meta name="msapplication-TileImage" content="https://vertx.tk/assets/favicons/vertx-favicon-7/mstile-144x144.png">
  <meta name="theme-color" content="#ffffff">

  <link href="https://fonts.googleapis.com/css?family=Ubuntu:400,500,700,400italic" rel="stylesheet" type="text/css">
  <link rel="alternate" type="application/rss+xml" title="RSS"
     href="https://vertx.tk/feed.xml">
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-30144458-1', 'auto');
    ga('create', 'UA-71153120-1', 'auto', 'tracker');
    ga('send', 'pageview');
    ga('tracker.send', 'pageview');
  </script>
</head>
<body>

<a href="http://www.reactivemanifesto.org/" id="reactive-manifesto-banner">
  <img style="border: 0; position: fixed; right: 0; top:0; z-index: 9000"
    src="https://d379ifj7s9wntv.cloudfront.net/reactivemanifesto/images/ribbons/we-are-reactive-black-right.png">
</a>

<a id="skippy" class="sr-only sr-only-focusable" href="#content"><div class="container"><span class="skiplink-text">Skip to main content</span></div></a>

<header class="navbar navbar-default navbar-static-top" id="top" role="banner">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#vertx-navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a href="https://vertx.tk/" class="navbar-brand"><img alt="Brand" src="https://vertx.tk/assets/logo-sm.png"></a>
    </div>
    <nav class="collapse navbar-collapse" id="vertx-navbar-collapse">
      <ul class="nav navbar-nav navbar-right">
        <li><a href="http://start.vertx.io">Starter</a></li>
        <li><a href="https://vertx.tk/download/">Download</a></li>
        <li><a href="https://vertx.tk/docs/">Documentation</a></li>
        <li><a href="https://github.com/vert-x3/wiki/wiki">Wiki</a></li>
        <li><a href="https://vertx.tk/community/">Community</a></li>
        <li><a href="https://vertx.tk/materials/">Materials</a></li>
        <li><a href="https://vertx.tk/blog/">Blog</a></li>
      </ul>
    </nav>
  </div>
</header>



  <div class="page-header" id="content">
    <div class="container">
      <div class="row">
        <div class="col-sm-12">
          <h1>Vert.x Web Client</h1>
          
        </div>
      </div>
    </div>
  </div>



<div id="content">
  <div class="container docs-content">
    <div class="row">
      <div class="col-sm-12 col-md-push-9 col-md-3 hidden-xs hidden-sm">
        <div id="sidebar" data-spy="affix">
          <ul class="sectlevel1">
<li><a href="#_using_the_web_client">Using the web client</a></li>
<li><a href="#_re_cap_on_vert_x_core_http_client">Re-cap on Vert.x core HTTP client</a></li>
<li><a href="#_creating_a_web_client">Creating a web client</a></li>
<li><a href="#_making_requests">Making requests</a>
<ul class="sectlevel2">
<li><a href="#_simple_requests_with_no_body">Simple requests with no body</a></li>
<li><a href="#_writing_request_bodies">Writing request bodies</a></li>
<li><a href="#_writing_request_headers">Writing request headers</a></li>
<li><a href="#_reusing_requests">Reusing requests</a></li>
<li><a href="#_timeouts">Timeouts</a></li>
</ul>
</li>
<li><a href="#_handling_http_responses">Handling http responses</a>
<ul class="sectlevel2">
<li><a href="#_decoding_responses">Decoding responses</a></li>
<li><a href="#_handling_30x_redirections">Handling 30x redirections</a></li>
</ul>
</li>
<li><a href="#_using_https">Using HTTPS</a></li>
<li><a href="#_rxjava_api">RxJava API</a></li>
</ul>
        </div>
      </div>
      <div class="col-sm-12 col-md-pull-3 col-md-9">
        <div class="toc hidden-md hidden-lg">
          <h2>Table of Contents</h2>
          <ul class="sectlevel1">
<li><a href="#_using_the_web_client">Using the web client</a></li>
<li><a href="#_re_cap_on_vert_x_core_http_client">Re-cap on Vert.x core HTTP client</a></li>
<li><a href="#_creating_a_web_client">Creating a web client</a></li>
<li><a href="#_making_requests">Making requests</a>
<ul class="sectlevel2">
<li><a href="#_simple_requests_with_no_body">Simple requests with no body</a></li>
<li><a href="#_writing_request_bodies">Writing request bodies</a></li>
<li><a href="#_writing_request_headers">Writing request headers</a></li>
<li><a href="#_reusing_requests">Reusing requests</a></li>
<li><a href="#_timeouts">Timeouts</a></li>
</ul>
</li>
<li><a href="#_handling_http_responses">Handling http responses</a>
<ul class="sectlevel2">
<li><a href="#_decoding_responses">Decoding responses</a></li>
<li><a href="#_handling_30x_redirections">Handling 30x redirections</a></li>
</ul>
</li>
<li><a href="#_using_https">Using HTTPS</a></li>
<li><a href="#_rxjava_api">RxJava API</a></li>
</ul>
        </div>
        <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x Web Client is an asynchronous HTTP and HTTP/2 client.</p>
</div>
<div class="paragraph">
<p>The Web Client makes easy to do HTTP request/response interactions with a web server, and provides advanced
features like:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Json body encoding / decoding</p>
</li>
<li>
<p>request/response pumping</p>
</li>
<li>
<p>request parameters</p>
</li>
<li>
<p>unified error handling</p>
</li>
<li>
<p>form submissions</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The web client does not deprecate the Vert.x Core <code><a href="../../apidocs/io/vertx/core/http/HttpClient.html">HttpClient</a></code>, indeed it is based on
this client and inherits its configuration and great features like pooling, HTTP/2 support, pipelining support, etc&#8230;&#8203;
The <code><a href="../../apidocs/io/vertx/core/http/HttpClient.html">HttpClient</a></code> should be used when fine grained control over the HTTP
requests/responses is necessary.</p>
</div>
<div class="paragraph">
<p>The web client does not provide a WebSocket API, the Vert.x Core <code><a href="../../apidocs/io/vertx/core/http/HttpClient.html">HttpClient</a></code> should
be used. It also does not handle cookies at the moment.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_web_client">Using the web client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use Vert.x Web Client, add the following dependency to the <em>dependencies</em> section of your build descriptor:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Maven (in your <code>pom.xml</code>):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
 &lt;groupId&gt;io.vertx&lt;/groupId&gt;
 &lt;artifactId&gt;vertx-web-client&lt;/artifactId&gt;
 &lt;version&gt;3.6.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Gradle (in your <code>build.gradle</code> file):</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-groovy" data-lang="groovy">dependencies {
 compile 'io.vertx:vertx-web-client:3.6.0-SNAPSHOT'
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_re_cap_on_vert_x_core_http_client">Re-cap on Vert.x core HTTP client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x Web Client uses the API from Vert.x core, so it&#8217;s well worth getting familiar with the basic concepts of using
<code><a href="../../apidocs/io/vertx/core/http/HttpClient.html">HttpClient</a></code> using Vert.x core, if you&#8217;re not already.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_creating_a_web_client">Creating a web client</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You create an <code><a href="../../apidocs/io/vertx/ext/web/client/WebClient.html">WebClient</a></code> instance with default options as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">WebClient client = WebClient.create(vertx);</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to configure options for the client, you create it as follows</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">WebClientOptions options = new WebClientOptions()
  .setUserAgent("My-App/1.2.3");
options.setKeepAlive(false);
WebClient client = WebClient.create(vertx, options);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Web Client options inherit Http Client options so you can set any one of them.</p>
</div>
<div class="paragraph">
<p>If your already have an HTTP Client in your application you can also reuse it</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">WebClient client = WebClient.wrap(httpClient);</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_making_requests">Making requests</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_simple_requests_with_no_body">Simple requests with no body</h3>
<div class="paragraph">
<p>Often, you’ll want to make HTTP requests with no request body. This is usually the case with HTTP GET, OPTIONS
and HEAD requests</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">WebClient client = WebClient.create(vertx);

// Send a GET request
client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .send(ar -&gt; {
    if (ar.succeeded()) {
      // Obtain response
      HttpResponse&lt;Buffer&gt; response = ar.result();

      System.out.println("Received response with status code" + response.statusCode());
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });

// Send a HEAD request
client
  .head(8080, "myserver.mycompany.com", "/some-uri")
  .send(ar -&gt; {
    if (ar.succeeded()) {
      // Obtain response
      HttpResponse&lt;Buffer&gt; response = ar.result();

      System.out.println("Received response with status code" + response.statusCode());
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can add query parameters to the request URI in a fluent fashion</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .addQueryParam("param", "param_value")
  .send(ar -&gt; {
    if (ar.succeeded()) {
      // Obtain response
      HttpResponse&lt;Buffer&gt; response = ar.result();

      System.out.println("Received response with status code" + response.statusCode());
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Any request URI parameter will pre-populate the request</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpRequest&lt;Buffer&gt; request = client.get(8080, "myserver.mycompany.com", "/some-uri?param1=param1_value&amp;param2=param2_value");

// Add param3
request.addQueryParam("param3", "param3_value");

// Overwrite param2
request.setQueryParam("param2", "another_param2_value");</code></pre>
</div>
</div>
<div class="paragraph">
<p>Setting a request URI discards existing query parameters</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpRequest&lt;Buffer&gt; request = client.get(8080, "myserver.mycompany.com", "/some-uri");

// Add param1
request.addQueryParam("param1", "param1_value");

// Overwrite param1 and add param2
request.uri("/some-uri?param1=param1_value&amp;param2=param2_value");</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_writing_request_bodies">Writing request bodies</h3>
<div class="paragraph">
<p>When you need to make a request with a body, you use the same API and call then <code>sendXXX</code> methods
that expects a body to send.</p>
</div>
<div class="paragraph">
<p>Use <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html#sendBuffer-io.vertx.core.buffer.Buffer-io.vertx.core.Handler-">sendBuffer</a></code> to send a buffer body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .post(8080, "myserver.mycompany.com", "/some-uri")
  .sendBuffer(buffer, ar -&gt; {
    if (ar.succeeded()) {
      // Ok
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Sending a single buffer is useful but often you don&#8217;t want to load fully the content in memory because
it may be too large or you want to handle many concurrent requests and want to use just the minimum
for each request. For this purpose the web client can send <code>ReadStream&lt;Buffer&gt;</code> (e.g a
<code><a href="../../apidocs/io/vertx/core/file/AsyncFile.html">AsyncFile</a></code> is a ReadStream&lt;Buffer&gt;`) with the <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html#sendStream-io.vertx.core.streams.ReadStream-io.vertx.core.Handler-">sendStream</a></code> method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .post(8080, "myserver.mycompany.com", "/some-uri")
  .sendStream(stream, ar -&gt; {
    if (ar.succeeded()) {
      // Ok
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>The web client takes care of setting up the transfer pump for you. Since the length of the stream is not know
the request will use chunked transfer encoding .</p>
</div>
<div class="paragraph">
<p>When you know the size of the stream, you shall specify before using the <code>content-length</code> header</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">fs.open("content.txt", new OpenOptions(), fileRes -&gt; {
  if (fileRes.succeeded()) {
    ReadStream&lt;Buffer&gt; fileStream = fileRes.result();

    String fileLen = "1024";

    // Send the file to the server using POST
    client
      .post(8080, "myserver.mycompany.com", "/some-uri")
      .putHeader("content-length", fileLen)
      .sendStream(fileStream, ar -&gt; {
        if (ar.succeeded()) {
          // Ok
        }
      });
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The POST will not be chunked.</p>
</div>
<div class="sect3">
<h4 id="_json_bodies">Json bodies</h4>
<div class="paragraph">
<p>Often you’ll want to send Json body requests, to send a <code><a href="../../apidocs/io/vertx/core/json/JsonObject.html">JsonObject</a></code>
use the <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html#sendJsonObject-io.vertx.core.json.JsonObject-io.vertx.core.Handler-">sendJsonObject</a></code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .post(8080, "myserver.mycompany.com", "/some-uri")
  .sendJsonObject(new JsonObject()
    .put("firstName", "Dale")
    .put("lastName", "Cooper"), ar -&gt; {
    if (ar.succeeded()) {
      // Ok
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Java, Groovy or Kotlin, you can use the <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html#sendJson-java.lang.Object-io.vertx.core.Handler-">sendJson</a></code> method that maps
a POJO (Plain Old Java Object) to a Json object using <code><a href="../../apidocs/io/vertx/core/json/Json.html#encode-java.lang.Object-">Json.encode</a></code>
method</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .post(8080, "myserver.mycompany.com", "/some-uri")
  .sendJson(new User("Dale", "Cooper"), ar -&gt; {
    if (ar.succeeded()) {
      // Ok
    }
  });</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the <code><a href="../../apidocs/io/vertx/core/json/Json.html#encode-java.lang.Object-">Json.encode</a></code> uses the Jackson mapper to encode the object
to Json.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_form_submissions">Form submissions</h4>
<div class="paragraph">
<p>You can send http form submissions bodies with the <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html#sendForm-io.vertx.core.MultiMap-io.vertx.core.Handler-">sendForm</a></code>
variant.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MultiMap form = MultiMap.caseInsensitiveMultiMap();
form.set("firstName", "Dale");
form.set("lastName", "Cooper");

// Submit the form as a form URL encoded body
client
  .post(8080, "myserver.mycompany.com", "/some-uri")
  .sendForm(form, ar -&gt; {
    if (ar.succeeded()) {
      // Ok
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default the form is submitted with the <code>application/x-www-form-urlencoded</code> content type header. You can set
the <code>content-type</code> header to <code>multipart/form-data</code> instead</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MultiMap form = MultiMap.caseInsensitiveMultiMap();
form.set("firstName", "Dale");
form.set("lastName", "Cooper");

// Submit the form as a multipart form body
client
  .post(8080, "myserver.mycompany.com", "/some-uri")
  .putHeader("content-type", "multipart/form-data")
  .sendForm(form, ar -&gt; {
    if (ar.succeeded()) {
      // Ok
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to upload files and send attributes, you can create a <code><a href="../../apidocs/io/vertx/ext/web/multipart/MultipartForm.html">MultipartForm</a></code> and
use <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html#sendMultipartForm-io.vertx.ext.web.multipart.MultipartForm-io.vertx.core.Handler-">sendMultipartForm</a></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">MultipartForm form = MultipartForm.create()
  .attribute("imageDescription", "a very nice image")
  .binaryFileUpload("imageFile", "image.jpg", "/path/to/image", "image/jpeg");

// Submit the form as a multipart form body
client
  .post(8080, "myserver.mycompany.com", "/some-uri")
  .sendMultipartForm(form, ar -&gt; {
    if (ar.succeeded()) {
      // Ok
    }
  });</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_writing_request_headers">Writing request headers</h3>
<div class="paragraph">
<p>You can write headers to a request using the headers multi-map as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpRequest&lt;Buffer&gt; request = client.get(8080, "myserver.mycompany.com", "/some-uri");
MultiMap headers = request.headers();
headers.set("content-type", "application/json");
headers.set("other-header", "foo");</code></pre>
</div>
</div>
<div class="paragraph">
<p>The headers are an instance of <code><a href="../../apidocs/io/vertx/core/MultiMap.html">MultiMap</a></code> which provides operations for adding,
setting and removing entries. Http headers allow more than one value for a specific key.</p>
</div>
<div class="paragraph">
<p>You can also write headers using putHeader</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpRequest&lt;Buffer&gt; request = client.get(8080, "myserver.mycompany.com", "/some-uri");
request.putHeader("content-type", "application/json");
request.putHeader("other-header", "foo");</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_reusing_requests">Reusing requests</h3>
<div class="paragraph">
<p>The <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html#send-io.vertx.core.Handler-">send</a></code> method can be called multiple times
safely, making it very easy to configure and reuse <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html">HttpRequest</a></code> objects</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpRequest&lt;Buffer&gt; get = client.get(8080, "myserver.mycompany.com", "/some-uri");
get.send(ar -&gt; {
  if (ar.succeeded()) {
    // Ok
  }
});

// Same request again
get.send(ar -&gt; {
  if (ar.succeeded()) {
    // Ok
  }
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Beware though that <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html">HttpRequest</a></code> instances are mutable.
Therefore you should call the <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html#copy--">copy</a></code> method before modifying a cached instance.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">HttpRequest&lt;Buffer&gt; get = client.get(8080, "myserver.mycompany.com", "/some-uri");
get.send(ar -&gt; {
  if (ar.succeeded()) {
    // Ok
  }
});

// The "get" request instance remains unmodified
get.copy().putHeader("a-header", "with-some-value").send(ar -&gt; {
  if (ar.succeeded()) {
    // Ok
  }
});</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_timeouts">Timeouts</h3>
<div class="paragraph">
<p>You can set a timeout for a specific http request using <code><a href="../../apidocs/io/vertx/ext/web/client/HttpRequest.html#timeout-long-">timeout</a></code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .timeout(5000)
  .send(ar -&gt; {
    if (ar.succeeded()) {
      // Ok
    } else {
      // Might be a timeout when cause is java.util.concurrent.TimeoutException
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>If the request does not return any data within the timeout period an exception will be passed to the response
handler.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handling_http_responses">Handling http responses</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the web client sends a request you always deal with a single async result <code><a href="../../apidocs/io/vertx/ext/web/client/HttpResponse.html">HttpResponse</a></code>.</p>
</div>
<div class="paragraph">
<p>On a success result the callback happens after the response has been received</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .send(ar -&gt; {
    if (ar.succeeded()) {

      HttpResponse&lt;Buffer&gt; response = ar.result();

      System.out.println("Received response with status code" + response.statusCode());
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
responses are fully buffered, use <code><a href="../../apidocs/io/vertx/ext/web/codec/BodyCodec.html#pipe-io.vertx.core.streams.WriteStream-">BodyCodec.pipe</a></code>
to pipe the response to a write stream
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_decoding_responses">Decoding responses</h3>
<div class="paragraph">
<p>By default the web client provides an http response body as a {@code Buffer} and does not apply
any decoding.</p>
</div>
<div class="paragraph">
<p>Custom response body decoding can be achieved using <code><a href="../../apidocs/io/vertx/ext/web/codec/BodyCodec.html">BodyCodec</a></code>:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Plain String</p>
</li>
<li>
<p>Json object</p>
</li>
<li>
<p>Json mapped POJO</p>
</li>
<li>
<p><code><a href="../../apidocs/io/vertx/core/streams/WriteStream.html">WriteStream</a></code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A body codec can decode an arbitrary binary data stream into a specific object instance, saving you the decoding
step in your response handlers.</p>
</div>
<div class="paragraph">
<p>Use <code><a href="../../apidocs/io/vertx/ext/web/codec/BodyCodec.html#jsonObject--">BodyCodec.jsonObject</a></code> To decode a Json object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .as(BodyCodec.jsonObject())
  .send(ar -&gt; {
    if (ar.succeeded()) {
      HttpResponse&lt;JsonObject&gt; response = ar.result();

      JsonObject body = response.body();

      System.out.println("Received response with status code" + response.statusCode() + " with body " + body);
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>In Java, Groovy or Kotlin, custom Json mapped POJO can be decoded</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .as(BodyCodec.json(User.class))
  .send(ar -&gt; {
    if (ar.succeeded()) {
      HttpResponse&lt;User&gt; response = ar.result();

      User user = response.body();

      System.out.println("Received response with status code" + response.statusCode() + " with body " +
        user.getFirstName() + " " + user.getLastName());
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>When large response are expected, use the <code><a href="../../apidocs/io/vertx/ext/web/codec/BodyCodec.html#pipe-io.vertx.core.streams.WriteStream-">BodyCodec.pipe</a></code>.
This body codec pumps the response body buffers to a <code><a href="../../apidocs/io/vertx/core/streams/WriteStream.html">WriteStream</a></code>
and signals the success or the failure of the operation in the async result response</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .as(BodyCodec.pipe(writeStream))
  .send(ar -&gt; {
    if (ar.succeeded()) {

      HttpResponse&lt;Void&gt; response = ar.result();

      System.out.println("Received response with status code" + response.statusCode());
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally if you are not interested at all by the response content, the <code><a href="../../apidocs/io/vertx/ext/web/codec/BodyCodec.html#none--">BodyCodec.none</a></code>
simply discards the entire response body</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .as(BodyCodec.none())
  .send(ar -&gt; {
    if (ar.succeeded()) {

      HttpResponse&lt;Void&gt; response = ar.result();

      System.out.println("Received response with status code" + response.statusCode());
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you don&#8217;t know in advance the content type of the http response, you can still use the {@code bodyAsXXX()} methods
that decode the response to a specific type</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .send(ar -&gt; {
    if (ar.succeeded()) {

      HttpResponse&lt;Buffer&gt; response = ar.result();

      // Decode the body as a json object
      JsonObject body = response.bodyAsJsonObject();

      System.out.println("Received response with status code" + response.statusCode() + " with body " + body);
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
this is only valid for the response decoded as a buffer.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_handling_30x_redirections">Handling 30x redirections</h3>
<div class="paragraph">
<p>By default the client follows redirections, you can configure the default behavior in the <code><a href="../../apidocs/io/vertx/ext/web/client/WebClientOptions.html">WebClientOptions</a></code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">WebClient client = WebClient.create(vertx, new WebClientOptions().setFollowRedirects(false));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The client will follow at most <code>16</code> requests redirections, it can be changed in the same options:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">WebClient client = WebClient.create(vertx, new WebClientOptions().setMaxRedirects(5));</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_https">Using HTTPS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Vert.x web client can be configured to use HTTPS in exactly the same way as the Vert.x <code><a href="../../apidocs/io/vertx/core/http/HttpClient.html">HttpClient</a></code>.</p>
</div>
<div class="paragraph">
<p>You can specify the behavior per request</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .get(443, "myserver.mycompany.com", "/some-uri")
  .ssl(true)
  .send(ar -&gt; {
    if (ar.succeeded()) {
      // Obtain response
      HttpResponse&lt;Buffer&gt; response = ar.result();

      System.out.println("Received response with status code" + response.statusCode());
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or using create methods with absolute URI argument</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">client
  .getAbs("https://myserver.mycompany.com:4043/some-uri")
  .send(ar -&gt; {
    if (ar.succeeded()) {
      // Obtain response
      HttpResponse&lt;Buffer&gt; response = ar.result();

      System.out.println("Received response with status code" + response.statusCode());
    } else {
      System.out.println("Something went wrong " + ar.cause().getMessage());
    }
  });</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_rxjava_api">RxJava API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The RxJava <code><a href="../../apidocs/io/vertx/rxjava/ext/web/client/HttpRequest.html">HttpRequest</a></code> provides an rx-ified version of the original API,
the <code><a href="../../apidocs/io/vertx/rxjava/ext/web/client/HttpRequest.html#rxSend--">rxSend</a></code> method returns a <code>Single&lt;HttpResponse&lt;Buffer&gt;&gt;</code> that
makes the HTTP request upon subscription, as consequence, the {@code Single} can be subscribed many times.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Single&lt;HttpResponse&lt;Buffer&gt;&gt; single = client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .rxSend();

// Send a request upon subscription of the Single
single.subscribe(response -&gt; System.out.println("Received 1st response with status code" + response.statusCode()), error -&gt; System.out.println("Something went wrong " + error.getMessage()));

// Send another request
single.subscribe(response -&gt; System.out.println("Received 2nd response with status code" + response.statusCode()), error -&gt; System.out.println("Something went wrong " + error.getMessage()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The obtained {@code Single} can be composed and chained naturally with the RxJava API</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Single&lt;String&gt; url = client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .rxSend()
  .map(HttpResponse::bodyAsString);

// Use the flatMap operator to make a request on the URL Single
url
  .flatMap(u -&gt; client.getAbs(u).rxSend())
  .subscribe(response -&gt; System.out.println("Received response with status code" + response.statusCode()), error -&gt; System.out.println("Something went wrong " + error.getMessage()));</code></pre>
</div>
</div>
<div class="paragraph">
<p>The same APIs is available</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Single&lt;HttpResponse&lt;JsonObject&gt;&gt; single = client
  .get(8080, "myserver.mycompany.com", "/some-uri")
  .putHeader("some-header", "header-value")
  .addQueryParam("some-param", "param value")
  .as(BodyCodec.jsonObject())
  .rxSend();
single.subscribe(resp -&gt; {
  System.out.println(resp.statusCode());
  System.out.println(resp.body());
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code><a href="../../apidocs/io/vertx/rxjava/ext/web/client/HttpRequest.html#sendStream-rx.Observable-io.vertx.core.Handler-">sendStream</a></code> shall
be preferred for sending bodies {@code Observable&lt;Buffer&gt;}</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-java" data-lang="java">Observable&lt;Buffer&gt; body = getPayload();

Single&lt;HttpResponse&lt;Buffer&gt;&gt; single = client
  .post(8080, "myserver.mycompany.com", "/some-uri")
  .rxSendStream(body);
single.subscribe(resp -&gt; {
  System.out.println(resp.statusCode());
  System.out.println(resp.body());
});</code></pre>
</div>
</div>
<div class="paragraph">
<p>Upon subscription, the {@code body} will be subscribed and its content used for the request.</p>
</div>
</div>
</div>

        

        
          <div id="footer">
            <div id="footer-text">
              
                上次更新时间 2018-09-04 18:06:10 CST
              
              
            </div>
          </div>
        
      </div>
    </div>
  </div>
</div>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-xs-4 col-sm-4 col-md-2 col-lg-2">
        <h2>Eclipse Vert.x</h2>
        <ul class="list-unstyled">
          <li><a href="https://vertx.tk/">Home</a></li>
          <li><a href="https://vertx.tk/download/">Download</a></li>
          <li><a href="https://vertx.tk/docs/">Documentation</a></li>
          <li><a href="https://github.com/vert-x3/wiki/wiki">Wiki</a></li>
          <li><a href="https://vertx.tk/blog/">Blog</a></li>
          <li><a href="https://vertx.tk/vertx2/" class="vertx-2-link">Vert.x 2</a></li>
        </ul>
      </div>
      <div class="col-xs-4 col-sm-4 col-md-2 col-lg-2">
        <h2>Community</h2>
        <ul class="list-unstyled">
          <li><a href="https://vertx.tk/community/">Help &amp; Contributors</a></li>
          <li><a href="https://vertx.tk/materials/">Learning materials</a></li>
          <li><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx">User Group</a></li>
          <li><a href="https://groups.google.com/forum/?fromgroups#!forum/vertx-dev">Developer Group</a></li>
        </ul>
      </div>
      <div class="col-xs-4 col-sm-4 col-md-2 col-lg-2">
        <h2>Eclipse</h2>
        <ul class="list-unstyled">
          <li><a href="http://www.eclipse.org/">Eclipse Foundation</a></li>
          <li><a href="https://eclipse.org/legal/privacy.php">Privacy Policy</a></li>
          <li><a href="https://eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
          <li><a href="https://eclipse.org/legal/copyright.php">Copyright Agent</a></li>
          <li><a href="http://www.eclipse.org/legal">Legal Resources</a></li>
        </ul>
      </div>

      <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 copyright">
        <p>Eclipse Vert.x is open source and dual-licensed under the <a href="http://www.eclipse.org/legal/epl-v20.html">Eclipse Public License 2.0</a> and <a href="https://www.apache.org/licenses/LICENSE-2.0.html">Apache License 2.0</a>.</p>
        <p>This website is licensed under the <a href="http://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0 License</a>.<br>
        Design by <a href="https://www.michel-kraemer.com">Michel Kr&auml;mer</a>.</p>
        <div class="row">
          <div class="col-sm-12 col-md-5 col-md-offset-1 col-lg-offset-2">
            <a href="http://eclipse.org">
            <img class="logo eclipse-logo" src="https://vertx.tk/assets/eclipse_logo_grey_small.png" width="204" height="48">
            </a>
          </div>
          <div class="col-sm-12 col-md-5 col-md-offset-1 col-lg-offset-0">
            <a href="http://cloudbees.com">
            <img class="logo cloudbees-logo" src="https://vertx.tk/assets/Button-Built-on-CB-1-grey.png" width="180" height="48">
           </a>
          </div>
          <div class="col-sm-12 col-md-5 col-md-offset-7 jprofiler">
            <a href="http://www.ej-technologies.com/products/jprofiler/overview.html"
            style="text-decoration:none">
            <img class="logo jprofiler-logo" src="https://vertx.tk/assets/jprofiler-logo.png" width="48" height="48"><span class="jprofiler-logo">&nbsp; JPROFILER</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="https://vertx.tk/javascripts/bootstrap.min.js"></script>
<script src="https://vertx.tk/javascripts/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



<script src="https://vertx.tk/javascripts/sidebar.js"></script>


<link rel="stylesheet" type="text/css" href="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.css" />
<script src="//cdnjs.cloudflare.com/ajax/libs/cookieconsent2/3.0.3/cookieconsent.min.js"></script>
<script>
window.addEventListener("load", function(){
window.cookieconsent.initialise({
  "palette": {
    "popup": {
      "background": "#64386b",
      "text": "#ffcdfd"
    },
    "button": {
      "background": "transparent",
      "text": "#f8a8ff",
      "border": "#f8a8ff"
    }
  },
  "content": {
    "message": "This website uses anonymous cookies to ensure we provide you the best experience. ",
    "link": "Opt out!",
    "href": "https://tools.google.com/dlpage/gaoptout/"
  }
})});
</script>
</body>
</html>

